# Path to models file - can be a local path or HTTP/HTTPS URL
# Examples:
#   modelsFile: ./models.yaml
#   modelsFile: https://example.com/models.yaml
# When using URL, the file is fetched at startup (not saved to disk)
modelsFile: ./models.yaml

# Provider settings
# Note: Use ${ENV_VAR_NAME} to reference any environment variable from .env file
providers:
  openrouter:
    enabled: true
    # API Key for OpenRouter service. Required if OpenRouter is enabled.
    apiKey: ${OPENROUTER_API_KEY}
    # Base URL for OpenRouter (optional, default: https://openrouter.ai/api/v1)
    # baseUrl: https://openrouter.ai/api/v1
    
  deepseek:
    enabled: true
    # API Key for DeepSeek service. Required if DeepSeek is enabled.
    apiKey: ${DEEPSEEK_API_KEY}
    # Base URL for DeepSeek (optional, default: https://api.deepseek.com)
    # baseUrl: https://api.deepseek.com

# Routing settings
routing:
  # Maximum retries on free models
  maxRetries: 3
  
  # Maximum retries on 429 rate limit for one model
  rateLimitRetries: 2
  
  # Delay between retries (ms) - only for rate limit (429) retries on the same model
  retryDelay: 1000
  # Note: Jitter Â±20% is hardcoded in RETRY_JITTER_PERCENT constant
  
  # Provider request timeout (ms)
  timeoutSecs: 30 # in seconds
  
  # Fallback to paid model
  fallback:
    enabled: true
    provider: deepseek        # or openrouter
    model: deepseek-chat      # model for fallback

# Circuit Breaker settings (optional, has defaults)
# circuitBreaker:
#   failureThreshold: 3       # Failures to open circuit (default: 3)
#   cooldownPeriodSecs: 60    # Cooldown in seconds (default: 60 = 1 min)
#   successThreshold: 2       # Successes to close from HALF_OPEN (default: 2)
#   statsWindowSizeMins: 5    # Statistics window in minutes (default: 5 mins)

# Model weight overrides (optional)
# Allows adjusting weights without editing models.yaml
# modelOverrides:
#   - name: llama-3.3-70b
#     weight: 5               # Lower weight = less likely to be selected
#     maxConcurrent: 10       # Limit concurrency
#   - name: deepseek-r1
#     provider: deepseek      # Optional validation
#     weight: 15              # Higher weight = more likely to be selected
#     available: false        # Temporarily disable

# Rate limiting settings (optional, disabled by default)
# rateLimiting:
#   enabled: false            # Enable rate limiting
#   
#   # Global limit (all clients combined)
#   global:
#     requestsPerMinute: 100  # Max requests per minute for all clients
#     
#   # Per-client limit (by X-Client-ID header or IP)
#   perClient:
#     enabled: true
#     requestsPerMinute: 20   # Max requests per minute per client
#     burstSize: 5            # Extra tokens for burst traffic
#     
#   # Per-model limit (protection against skew)
#   perModel:
#     enabled: true
#     requestsPerMinute: 30   # Max requests per minute per model
